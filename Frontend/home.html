<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Shrinker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
       <h1 id="logo">Link Shrinker</h1>
    </nav>

    <div id="container">
        <h1 style="margin-bottom: 30px;">Generate Short URL</h1>
        <div id="main">
            <input type="text" id="longUrl" placeholder="Paste Your Long URL" autocomplete="off">
            <button onclick="generateShortUrl()">Generate</button>
        </div>
    </div>
</body>
</html>
<script>

    async function generateShortUrl() {
        const longUrl = document.getElementById("longUrl").value;
        try {
            const response = await fetch("http://localhost:8900/generate-short-url",{
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json"
                                },
                                body: JSON.stringify({longUrl})
                            });

            if(response.status == 200){
                const data = await response.json();
                const shortUrl = data.shortUrl;
                displayShortUrl(shortUrl);
            }else{
                alert("Something went wrong");
            }

        } catch (error) {
            alert(error.message);
        }
    }

    function displayShortUrl(shortUrl) {
        document.getElementById("container").innerHTML = `
            <h2 style="margin-bottom: 30px;">Generated Short URL</h2>
            <div class="short-url-container">
                <input type="text" id="short-url" value=${shortUrl} readonly>
                <button onclick="copyShortUrl()">Copy</button>
            </div>

        `;
    }


    function copyShortUrl() {
        const shortUrlInput = document.getElementById("short-url");
        shortUrlInput.select(); // Select the text in the input
        shortUrlInput.setSelectionRange(0, 99999); // For mobile devices
        navigator.clipboard.writeText(shortUrlInput.value) // Copy to clipboard
        .then(() => {
            alert("Short URL copied to clipboard!");
        })
        .catch((err) => {
            console.error("Failed to copy: ", err);
        });
    }


</script>